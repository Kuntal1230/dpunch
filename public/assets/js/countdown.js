(function($){$.fn.countdown=function(options,callback){var settings={'date':null,'format':null};if(options){$.extend(settings,options);}var interval=new Array($(this).length);var timeNow=new Array($(this).length);function countdown_proc(element,index){var thisEl=element;if(typeof timeNow[index]=='undefined'){timeNow[index]=em_now;}else{timeNow[index]+=1;}var eventDate=thisEl.parent().find('.time').html();var currentDate=Math.floor(timeNow[index]);if(eventDate<=currentDate){callback.call(this);clearInterval(interval[index]);}var seconds=eventDate-currentDate;if(seconds<=0)return false;var days=Math.floor(seconds/(60*60*24));seconds-=days*60*60*24;var hours=Math.floor(seconds/(60*60));seconds-=hours*60*60;var minutes=Math.floor(seconds/60);seconds-=minutes*60;if(days==1){thisEl.find(".timeRefDays").text(em_deal_date.day);}else{thisEl.find(".timeRefDays").text(em_deal_date.days);}if(hours==1){thisEl.find(".timeRefHours").text(em_deal_date.hour);}else{thisEl.find(".timeRefHours").text(em_deal_date.hours);}if(minutes==1){thisEl.find(".timeRefMinutes").text(em_deal_date.minute);}else{thisEl.find(".timeRefMinutes").text(em_deal_date.minutes);}if(thisEl.find(".timeRefSeconds").length)if(seconds==1){thisEl.find(".timeRefSeconds").text(em_deal_date.second);}else{thisEl.find(".timeRefSeconds").text(em_deal_date.seconds);}if(settings['format']=="on"){days=(String(days).length>=2)?days:"0"+days;hours=(String(hours).length>=2)?hours:"0"+hours;minutes=(String(minutes).length>=2)?minutes:"0"+minutes;seconds=(String(seconds).length>=2)?seconds:"0"+seconds;}if(!isNaN(eventDate)){thisEl.find(".days").text(days);thisEl.find(".hours").text(hours);thisEl.find(".minutes").text(minutes);if(thisEl.find(".seconds").length)thisEl.find(".seconds").text(seconds);}else{clearInterval(interval[index]);}}$(this).each(function(index){var element=$(this);interval[index]=setInterval(function(){countdown_proc(element,index);},1000);});}})(jQuery);